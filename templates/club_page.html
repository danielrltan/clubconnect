{% extends 'base.html' %}

{% block content %}
    <h1 class="title">{{ club.name }}</h1>
    <div class="content">
        <div class="club">
            <b>
                <p class="name">{{ club.name }}</p>
            </b>
            <div class="info">
                {% if club.pictureblob %}
                    <img src="{{ url_for('fetchprofilepic', club_name=club.name) }}" class="clubimage" alt="{{ club.name }} profile picture">
                {% else %}
                    <img src="path/to/default/image.jpg" class="clubimage" alt="{{ club.name }} profile picture">
                {% endif %}
                <div class="description">
                    <h4>Description</h4>
                    <p>{{ club.description|safe }}</p>
                </div>
                <div class="contact">
                    <h4>Contact</h4>
                    <p>{{ club.contact }}</p>
                </div>
                <div class="social-media">
                    <h4>Social Media</h4>
                    <ul>
                        {% if club.instagram %}<li>Instagram: <a href="{{ club.instagram }}">{{ club.instagram }}</a></li>{% endif %}
                        {% if club.youtube %}<li>YouTube: <a href="{{ club.youtube }}">{{ club.youtube }}</a></li>{% endif %}
                        {% if club.linkedin %}<li>LinkedIn: <a href="{{ club.linkedin }}">{{ club.linkedin }}</a></li>{% endif %}
                        {% if club.website %}<li>Website: <a href="{{ club.website }}">{{ club.website }}</a></li>{% endif %}
                        {% if club.facebook %}<li>Facebook: <a href="{{ club.facebook }}">{{ club.facebook }}</a></li>{% endif %}
                        {% if club.twitter %}<li>Twitter: <a href="{{ club.twitter }}">{{ club.twitter }}</a></li>{% endif %}
                    </ul>
                </div>
                <div class="events">
                    <h4>Events</h4>
                    <ul>
                        {% for event in club.events %}
                            <li>{{ event.date }} - {{ event.title }}</li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="officers">
                    <h4>Officers</h4>
                    <ul>
                        {% for officer in club.officers %}
                            <li>{{ officer.name }} - {{ officer.position }}</li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="ratings">
                    <h4>{{ club.name}} Ratings</h4>
                    <p>Overall Rating: {{ average_overall_rating }}</p>
                    <p>Meeting Frequency: {{ average_meeting_frequency }}</p>
                    <ul>
                        {% for rating in club.ratings %}
                        <h5>User rating</h5>
                        <li>Overall Rating: {{ rating.overall_rating }}</li>
                        <li>Meeting Frequency: {{ rating.meeting_frequency }}</li>
                        <li>Comment: {{ rating.comment|default('No comment provided') }}</li>
                        <button type="button" onclick="window.location.href='{{ url_for('edit_rating', club_name=club.name, rating_id=rating.id) }}'" class="edit-btn">‚úèÔ∏è</button>
                        <form method="POST">
                            <input type="submit" formaction="{{ url_for('delete_rating', club_name=club.name, rating_id=rating.id) }}" value="üóëÔ∏è" onclick="return confirm('Are you sure you want to delete this rating?')">
                        </form>
                        <h3></h3>
                        {% endfor %}
                    </ul>
                </div>
    
                <div class="rating-form">
                    <h4>Rate {{ club.name }}</h4>
                    <form method="POST" action="{{ url_for('rate_club', club_name=club.name) }}" onsubmit="return validateForm()">
                        <div class="form-group">
                            <label for="overall_rating">Overall Rating:</label>
                            <input type="number" id="overall_rating" name="overall_rating" min="0.5" max="5" step="0.5" required>
                        </div>
                        <div class="form-group">
                            <label for="meeting_frequency">Meeting Frequency:</label>
                            <input type="number" id="meeting_frequency" name="meeting_frequency" min="0.5" max="5" step="0.5" required>
                        </div>
                        <div class="form-group">
                            <label for="comment">Comment:</label>
                            <textarea id="comment" name="comment" placeholder="Enter a comment"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </form>
                </div>
                <div class="contact-button">
                    <a href="https://westernu.campuslabs.ca/engage/organization/{{ club.websitekey }}/contact" class="clubinfobtn">Contact</a>
                </div>
                <div class="events-button">
                    <a href="https://westernu.campuslabs.ca/engage/organization/{{ club.websitekey }}/events" class="clubinfobtn">Events</a>
                </div>
                <div class="roster-button">
                    <a href="https://westernu.campuslabs.ca/engage/organization/{{ club.websitekey }}/roster" class="clubinfobtn">Officers</a>
                </div>
                <div class="gallery-button">
                    <a href="https://westernu.campuslabs.ca/engage/organization/{{ club.websitekey }}/gallery" class="clubinfobtn">Gallery</a>
                </div>
            </div>
        </div>
    </div>
{% endblock %}